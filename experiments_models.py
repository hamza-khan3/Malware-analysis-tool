
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import classification_report
from train_model import load_and_preprocess_data  # Ensure to import properly based on your project structure

def experiment_with_models(X_train, y_train, X_test, y_test):
    models = {
        'Random Forest': RandomForestClassifier(n_estimators=100, random_state=42),
        'Neural Network': build_and_train_model(X_train, y_train, X_test, y_test)[0],  # This function should be adapted if itâ€™s only meant for Neural Networks
    }

    for name, model in models.items():
        print(f"Training {name}...")
        model.fit(X_train, y_train)
        predictions = model.predict(X_test)
        print(f"Classification Report for {name}:")
        print(classification_report(y_test, predictions))

def main():
    X_train, X_test, y_train, y_test = load_and_preprocess_data('malware_features.csv')
    experiment_with_models(X_train, y_train, X_test, y_test)

if __name__ == "__main__":
    main()
